const wrapper=document.querySelector(".puzzle__inside"),gems=document.querySelectorAll("button"),buttonSize=gems[0].offsetWidth,alpha=[];for(let e=0;e<26;e++)alpha[e]=gems[e].innerHTML;function getRandomInt(e){return Math.floor(Math.random()*e)}let gemsCopy={...gems};function rundomize(){const e=[...alpha];for(let t=0;t<26;t++){let o=getRandomInt(e.length);gemsCopy[t].innerHTML=e[o],e.splice(o,1)}}let emptyIndex=29;const soundMove=new Audio("sounds/move.mp3"),soundStart=new Audio("sounds/start.mp3"),soundFinish=new Audio("sounds/finish.mp3");let isMoving=!1;wrapper.addEventListener("click",(e=>{const t=e.target.closest("button");if(0==isMoving&&t&&"BUTTON"===t.tagName&&"ready"!==state){let m;isMoving=!0,Object.entries(gemsCopy).map(((e,o)=>{e[1]===t&&(m=o)}));const a=document.querySelector(".empty");Object.entries(gemsCopy).map(((e,t)=>{e[1]===a&&(emptyIndex=t)}));const i=window.getComputedStyle(t).transform.match(/matrix.*\((.+)\)/)[1].split(", "),l=Number(i[4]),c=Number(i[5]);function o(e){m+1===emptyIndex&&(e.style.transform=`translate(${l+buttonSize}px, ${c}px)`,gemsCopy[m]=a,gemsCopy[emptyIndex]=e,moveCount++,moves.textContent=`Move: ${moveCount}`,soundMove.play())}function n(e){m-1===emptyIndex&&(e.style.transform=`translate(${l-buttonSize}px, ${c}px)`,gemsCopy[m]=a,gemsCopy[emptyIndex]=e,moveCount++,moves.textContent=`Move: ${moveCount}`,soundMove.play())}function s(e){m-5===emptyIndex&&(e.style.transform=`translate(${l}px, ${c-buttonSize}px)`,gemsCopy[m]=a,gemsCopy[emptyIndex]=e,moveCount++,moves.textContent=`Move: ${moveCount}`,soundMove.play())}function r(e){m+5===emptyIndex&&(e.style.transform=`translate(${l}px, ${c+buttonSize}px)`,gemsCopy[m]=a,gemsCopy[emptyIndex]=e,moveCount++,moves.textContent=`Move: ${moveCount}`,soundMove.play())}switch(!0){case 0===m:o(t),r(t);break;case 4===m:n(t),r(t);break;case 29===m:n(t),s(t);break;case 25===m:s(t),o(t);break;case m>0&&m<4:n(t),o(t),r(t);break;case m%5==4:s(t),n(t),r(t);break;case m>25&&m<29:s(t),n(t),o(t);break;case m%5==0:s(t),o(t),r(t);break;case m%5==1||m%5==2||m%5==3:s(t),n(t),o(t),r(t)}}checkProgress(),setTimeout((()=>{isMoving=!1}),315)}));const timer=document.getElementById("time"),moves=document.getElementById("move"),playButton=document.getElementById("play-button");let intervalId,time,timerSeconds=0,moveCount=0,state="ready";function updateTimer(){timerSeconds++;const e=Math.floor(timerSeconds/60).toString().padStart(2,"0"),t=(timerSeconds%60).toString().padStart(2,"0");time=`${e}:${t}`,timer.textContent=`Time: ${time}`}function startGame(){intervalId=setInterval(updateTimer,1e3),playButton.textContent="Reset",state="in-progress",rundomize(),soundStart.play()}function resetGame(){clearInterval(intervalId),timerSeconds=0,timer.textContent="Time: 00:00",moveCount=0,moves.textContent="Move: 0",scores.style.display="none",winTitle.style.display="none",scoreButton.style.display="flex",gemsCopy={...gems};for(let e=0;e<29;e++)gems[e].style.transform=""}playButton.addEventListener("click",(()=>{"ready"===state||resetGame(),startGame()}));const scores=document.querySelector(".scores"),scoreButton=document.getElementById("score-button"),scoreList=document.querySelector(".score-list"),winTitle=document.querySelector(".scores-win");function getGameResults(){return JSON.parse(localStorage.getItem("gameResults"))||[]}function saveGameResults(e,t,o){const n={time:e,moves:t,timerSeconds:o},s=getGameResults();s.push(n),s.sort(((e,t)=>e.timerSeconds-t.timerSeconds)),localStorage.setItem("gameResults",JSON.stringify(s.slice(0,5)))}function showResults(){scoreList.innerHTML="";const e=getGameResults();if(0!==e.length){const t=document.createElement("ol");scoreList.appendChild(t);for(let o=0;o<e.length;o++){const n=document.createElement("li");n.innerHTML=`Time: ${e[o].time}, Moves: ${e[o].moves}`,t.appendChild(n)}}else scoreList.innerHTML="..."}function checkProgress(){let e=[];for(let t=0;t<26;t++)e[t]=gemsCopy[t].innerHTML;e.every(((e,t)=>e===alpha[t]))&&(playButton.textContent="Reset",scores.style.display="flex",winTitle.style.display="block",state="finished",clearInterval(intervalId),saveGameResults(time,moveCount,timerSeconds),showResults(),scoreButton.style.display="none",soundFinish.play())}scoreButton.addEventListener("click",(()=>{"Scores"===scoreButton.innerHTML?(scores.style.display="flex",scoreButton.innerHTML="hide",showResults()):(scores.style.display="none",scoreButton.innerHTML="Scores")}));